jQuery(document).ready(function($){if(typeof Spinner!=='undefined'&&typeof modal_login_script!=='undefined'){var spinner_color=(modal_login_script.ajax_spinner_color!=='')?modal_login_script.ajax_spinner_color:'#fff';var opts={lines:10,length:4,width:4,radius:10,corners:1,rotate:0,color:spinner_color,speed:1,trail:60,shadow:false,hwaccel:false,className:'spinner',zIndex:2e9,top:25,left:25};var target=document.getElementById('paml-spinner');var spinner=new Spinner(opts).spin(target);}
$('a.ml-close-btn').click(function(e){e.preventDefault();$("#open_saved_search_listing").remove();$("#open_saved_search").remove();$('.ml-modal ').trigger('click');});$('.modal-login-content:not(:first)').hide();$('.modal-login-nav').click(function(e){$('.modal-login-content > p.message').remove();var form_field=$(this).attr('href');$('.modal-login-content').hide();$('.section-container '+ form_field).fadeIn(700);e.preventDefault();if(form_field==='#login'){$(this).parent().fadeOut().removeClass().addClass('hide-login');}else{$('a[href="#login"]').parent().removeClass().addClass('inline').fadeIn();}});$('#modal-login #form').on('submit',function(e){e.preventDefault();var form_id=$(this).parent().attr('id');$('.modal-login-content > p.message').remove();if(form_id==='login'){$.ajax({type:'POST',dataType:'json',url:modal_login_script.ajax,data:{'action':'ajaxlogin','username':$('#form #login_user').val(),'password':$('#form #login_pass').val(),'rememberme':($('#form #rememberme').is(':checked'))?"TRUE":"FALSE",'login':$('#form input[name="login"]').val(),'security':$('#form #security').val()},beforeSend:function(){$('.ml-modal').addClass('is-active');},success:function(results){if(results.loggedin===true){$('.modal-login-content > h2').after('<p class="message success"></p>');$('.modal-login-content > p.message').text(results.message).show();$('#overlay, .login-popup').delay(5000).fadeOut('300m',function(){$('#overlay').remove();});if($("#open_saved_search").length){$('.ml-close-btn').trigger('click');$('#myContactModal').modal('show');}else if($("#open_saved_search_listing").length){$('.ml-close-btn').trigger('click');window.location.href='http://alaskadreammakers.info/saved-search/';}else{window.location.href=modal_login_script.redirecturl;}}else{$('.modal-login-content > h2').after('<p class="message error"></p>');$('.modal-login-content > p.message').text(results.message).show();}},complete:function(){$('.ml-modal').removeClass('is-active');}});}else if(form_id==='register'){$.ajax({type:'POST',dataType:'json',url:modal_login_script.ajax,data:{'action':'ajaxlogin','user_phone':$('#form #reg_phone').val(),'username':$('#form #reg_user').val(),'email':$('#form #reg_email').val(),'register':$('#form input[name="register"]').val(),'security':$('#form #security').val(),'password':$('#form #reg_password').val()},beforeSend:function(){$('.ml-modal').addClass('is-active');},success:function(results){if(results.registerd===true){$('.modal-login-content > h2').after('<p class="message success"></p>');$('.modal-login-content > p.message').text(results.message).show();$('#register #form input:not(#user-submit)').val('');$('#overlay, .login-popup').delay(5000).fadeOut('300m',function(){$('#overlay').remove();});if($("#open_saved_search").length){$('.ml-close-btn').trigger('click');$('#myContactModal').modal('show');}else if($("#open_saved_search_listing").length){$('.ml-close-btn').trigger('click');window.location.href='http://alaskadreammakers.info/saved-search/';}else if($("#open_saved_listing").length){$('.ml-close-btn').trigger('click');window.location.href='http://alaskadreammakers.info/saved-listing/';}else if($("#save_listing_process").length){$('.ml-close-btn').trigger('click');$('#save-my-list').trigger('click');}else{window.location.href=modal_login_script.redirecturl;}}else{$('.modal-login-content > h2').after('<p class="message error"></p>');$('.modal-login-content > p.message').text(results.message).show();}},complete:function(){$('.ml-modal').removeClass('is-active');}});}else if(form_id==='forgotten'){$.ajax({type:'POST',dataType:'json',url:modal_login_script.ajax,data:{'action':'ajaxlogin','username':$('#form #forgot_login').val(),'forgotten':$('#form input[name="forgotten"]').val(),'security':$('#form #security').val()},beforeSend:function(){$('.ml-modal').addClass('is-active');},success:function(results){if(results.reset===true){$('.modal-login-content > h2').after('<p class="message success"></p>');$('.modal-login-content > p.message').text(results.message).show();$('#forgotten #form input:not(#user-submit)').val('');}else if($("#my_saved_search_listing").length){$('.ml-close-btn').trigger('click');window.location.href='http://alaskadreammakers.info/saved-search/';}else if($("#open_saved_listing").length){$('.ml-close-btn').trigger('click');window.location.href='http://alaskadreammakers.info/saved-listing/';}else if($("#save_listing_process").length){$('.ml-close-btn').trigger('click');$('#save-my-list').trigger('click');}else{$('.modal-login-content > h2').after('<p class="message error"></p>');$('.modal-login-content > p.message').text(results.message).show();}},complete:function(){$('.ml-modal').removeClass('is-active');}});}else{$('.modal-login-content > h2').after('<p class="message error"></p>');$('.modal-login-content > p.message').text('Something  Please refresh your window and try again.');}});$('a[href="#modal-login"]').click(function(){$('a[href="#login"]:eq(0)').click();});$('a[href="#modal-register"]').click(function(){$('a[href="#modal-login"]:eq(0), a[href="#register"]').click();});});function updateQueryStringParameter(uri,key,value){var re=new RegExp("([?&])"+ key+"=.*?(&|$)","i");var separator=uri.indexOf('?')!==-1?"&":"?";if(uri.match(re)){return uri.replace(re,'$1'+ key+"="+ value+'$2');}else{return uri+ separator+ key+"="+ value;}}